<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Usual problems encountered when using lcmm package</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>





<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Usual problems encountered when using lcmm package</h1>


<div id="TOC">
<ul>
<li><a href="#why-my-model-did-not-converge">Why my model did not converge?</a></li>
<li><a href="#how-to-choose-the-number-of-latent-classes">How to choose the number of latent classes?</a></li>
<li><a href="#how-to-evaluate-the-quality-of-a-classification">How to evaluate the quality of a classification ?</a></li>
<li><a href="#how-to-evaluate-the-fit-of-a-model">How to evaluate the fit of a model ?</a></li>
<li><a href="#how-to-pre-normalize-a-variable-using-lcmm">How to pre-normalize a variable using lcmm ?</a></li>
</ul>
</div>

<p> </p>
<p>We list here some recurrent problems reported by users. Other issues, questions, concerns may have been reported in github: <a href="https://github.com/CecileProust-Lima/lcmm/issues/" class="uri">https://github.com/CecileProust-Lima/lcmm/issues/</a> .</p>
<p><strong>Please refer to github, both closed and opened issues, before sending any question. And please ask the questions via github only.</strong></p>
<p> </p>
<div id="why-my-model-did-not-converge" class="section level1">
<h1>Why my model did not converge?</h1>
<p>It sometimes happens that a model does not converge correctly. This is due most of the time to the very stringent criterion based on the “derivatives”. This criterion uses both the first derivatives and the inverse of the matrix of the second derivatives (Hessian). It ensures that the program converges at a maximum. When it can’t be computed correctly (most of the time because the Hessian is not definite positive), the program reports “second derivatives = 1”.</p>
<p><strong>There are several reasons that may induce a non convergence, e.g.:</strong></p>
<ol style="list-style-type: decimal">
<li><p>When the time variable (or more generally a variable with random effects) is in a unit which induces too small associated parameters (for very small changes per day). In that case, changing the scale (for instance with months or years) may solve the problem.</p></li>
<li><p>In models with splines in the link function (lcmm, multlcmm, Jointlcmm) or with splines in the baseline risk function (Jointlcmm), a parameter associated with splines very close to zero may prevent for correct convergence as it is at the border of the parameter space. In that case, this parameter can be fixed to 0 and convergence should be reached immediately.</p></li>
<li><p>When the data are not rich enough and/or the model is too complicated. In that case, this is a problem of numerical non identifiability. There are not many solutions (other than simplifying the model) but some directions may be :</p>
<ul>
<li>Be patient, it happens that after some iterations the derivatives might be inversible and the model converges (you can change maxiter or rerun the program from the estimates at the non convergence point). But this is usually no necessary to specify more than 100 or 200 iterations. The iterative algorithm is used to converge in a few dozen of iterations.</li>
<li>You can try to assume a less stringent threshold (e.g., 0.01) but be careful, convergence might be of lower quality.<br />
</li>
<li>Run the model from different initial values.</li>
</ul></li>
</ol>
<p> </p>
</div>
<div id="how-to-choose-the-number-of-latent-classes" class="section level1">
<h1>How to choose the number of latent classes?</h1>
<p>Selection of the number of latent classes is a complex question. In some cases, the number is known. When not, different tools can be used to guide the decision:</p>
<ul>
<li>Several statistical criteria such as BIC, SABIC or Entropy</li>
<li>Statistical tests when available: score test for conditional independence in joint models</li>
<li>Discrimination power as described by the classification table using the command postprob</li>
<li>Size of the classes (we can consider that classes should be larger than 1% or 5% depending on the context)</li>
<li>Clinical aspects and interpretation should also be taken into account</li>
</ul>
<p>Finally, it can be useful to present and contrast models with different numbers of latent classes.</p>
<p>The complexity of the selection of the optimal number of latent classes is illustrated in vignette: <a href="https://cran.r-project.org/package=lcmm/vignettes/latent_class_model_with_hlme.html" class="uri">https://cran.r-project.org/package=lcmm/vignettes/latent_class_model_with_hlme.html</a> . Indeed, all the criteria may not be concordant in practice.</p>
<p> </p>
</div>
<div id="how-to-evaluate-the-quality-of-a-classification" class="section level1">
<h1>How to evaluate the quality of a classification ?</h1>
<p>Good discrimination of classes is usually sought when fitting latent class mixed models. Discriminatory power can be assessed using the entropy criterion (provided in summarytable) but also using the classification table (with command postprob). The description of the classes may also help comprehend the latent class structure.</p>
<p>(see vignette <a href="https://cran.r-project.org/package=lcmm/vignettes/latent_class_model_with_hlme.html" class="uri">https://cran.r-project.org/package=lcmm/vignettes/latent_class_model_with_hlme.html</a> for further details)</p>
<p> </p>
</div>
<div id="how-to-evaluate-the-fit-of-a-model" class="section level1">
<h1>How to evaluate the fit of a model ?</h1>
<p>Different techniques can be used in this package to evaluate the goodness of fit. As in mixed models, one can compare the subject-specific predictions with the observations or plot the subject-specific residuals.</p>
<p>The comparison with more flexible models can also be useful (more flexible link functions, more flexible baseline risk functions, more flexible functions of time, etc.)</p>
<p>Each vignette includes a section on the evaluation of the model.</p>
<p> </p>
</div>
<div id="how-to-pre-normalize-a-variable-using-lcmm" class="section level1">
<h1>How to pre-normalize a variable using lcmm ?</h1>
<p>This is detailed in vignette on pre-normalizing: <a href="https://cran.r-project.org/package=lcmm/vignettes/pre_normalizing.html" class="uri">https://cran.r-project.org/package=lcmm/vignettes/pre_normalizing.html</a></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
